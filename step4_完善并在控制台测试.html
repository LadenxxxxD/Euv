<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>step4_完善并在控制台测试</title>
</head>

<body>
    <script>
        // 这里使用稍微高级一点的写法 带领大家循序渐进 思路和之前是一样的
        function observe(data) {
            if (!data || typeof data !== 'object') {
                return;
            }
            Object.keys(data).forEach(key => {
                let value = data[key];
                observe(value);
                Object.defineProperty(data, key, {
                    configurable: true,
                    enumerable: true,
                    get: () => {
                        console.log("捕获到 正在读取", key, " => ", value);
                        return value;
                    },
                    set: newValue => {
                        if (newValue === value) {
                            console.log("与原来值一样 未更改");
                            return;
                        }
                        console.log(key, " => ", value, " 已经更改为 ", key, " => ", newValue);
                        value = newValue;
                        observe(newValue); // 这里不要忘了给新赋的值添加监听 因为新赋的值也可能是个嵌套的对象
                    }
                });
            }
    </script>
</body>

</html>